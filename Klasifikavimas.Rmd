---
title: "Klasifikavimas"
author: "Asta KvedaraitÄ— & Marius Survila"
date: "5/27/2020"
output: html_document
---

```{r echo = FALSE, message=FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  error = TRUE,
  echo = FALSE 
)
```

```{r}
corrected <- read.csv("../output/correctedSample.csv")
data <- readRDS("../output/betab.rds")
head(as.data.frame(data))
```


```{r}
#Randomly shuffle the data

sample<-data[sample(nrow(data)),]

#Create 10 equally size folds
folds <- cut(seq(2,ncol(sample)),breaks=10, labels = FALSE)
#Perform 10 fold cross validation
for(i in 1:10){
  #Segement your data by fold using the which() function 
  testIndexes <- which(folds==i,arr.ind=TRUE)
  testData <- sample[,testIndexes ]
  knownData <- sample[,-testIndexes ]
  #Use the test and train data partitions however you desire...
}

```

```{r}

ncol(testData)
nrow(testData)
ncol(knownData)
testData <- t(testData[1:5,1:5])
knownData <- t(knownData[1:5,1:5])
testData <- as.data.frame(testData)
knownData <- as.data.frame(knownData)
```

```{r}

getGroup <- function(test, known, k){
  names <- c()   
  testtypes <- c()
  for (i in 1: ncol(test)){
     d <- dist(rbind(test[i,], known),  method = "euclidean")
     m <- min(d)
     d <- as.matrix(d)
     d <- as.data.frame(d)
     d <- d[,1]
     max <- sort(d[d > 0])[1:k]
     names <- c()
     for (j in 1 : length(max)){
       ind <- which(d==max[j])[1]
       names[j] <- rownames(known)[ind]
     }
     types <- c()
     for (n in 1: length(names)){
       types[n] <- corrected$sample[corrected$sample_id == names[n]]
     }
     t <- table(types)
     print(names(t[1]))
     if (t[1] > t[2]){
       testtypes[i] <- names(t[1])
     }else{
       testtypes[i] <- names(t[2])
     }
     
  }
  return(testtypes)
}

```


```{r}

getGroup(testData, knownData, 3)

```