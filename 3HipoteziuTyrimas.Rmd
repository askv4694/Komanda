---
title: "Hipotezių testas"
author: "Asta Kvedaraitė & Marius Survila"
date: "5/18/2020"
output: html_document
---

```{r echo = FALSE, message=FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  error = TRUE,
  echo = FALSE 
)
```

# Lyginamos grupės: sveiki/sergantys ir jų amžius.
```{r}
sample <- read.csv("../output/correctedSample.csv")
age <- sample$age
alzheimer <- sample$sample
test <- t.test(age ~ alzheimer)
test$statistic[[1]]
```
Norint nustatyti sveikų ir sergančių amžiaus vidurkį, buvo atliktas T testas dviem nepriklausomoms grupėms.
Sveikų žmonių grupės amžiaus vidurkis yra `r test$estimate[[2]]`, o sergančiųjų ažmiaus vidurkis = `r test$estimate[[1]]`.
P-reikšmė = `r test$p.value`, `r test$statistic[[1]]`.

```{r}
plot(sample$age~ sample$sample, main= "Sveikų ir sergančių amžiaus pasiskirstymas", xlab = NA, ylab ="Age")

```


```{r}
if (!require("matrixTests")) install.packages("matrixTests")
if (!require("reshape2")) install.packages("reshape2")
library("matrixTests")
library(ggplot2)
library(grid)
library(gridExtra)
library(reshape2)
data <- readRDS("../output/betab.rds")
nrow(data)


dfdata <- matrixTests::row_t_onesample(data)
dfdata <- dfdata[order(dfdata$statistic, decreasing = TRUE),]
head(dfdata)
dfdata <- dfdata[1:5,]
df <- rownames(dfdata[1:5,])
df <- data[df,]
df <- as.data.frame(t(df))

head(df)
#control <- df[df$sample == "Control",]
#alzheimer <- df[df$sample == "Alzheimer",]
#ggplot(df, aes(x = rownames(df), y = df[,1])) +
#  geom_point(color = "red")
head(df)
  df[] <- lapply(df, function(x) {
    if(is.factor(x)) as.numeric(as.character(x)) else x
})
#df$sample <- sample$sample
sapply(data, typeof)
```

```{r}
library(tidyr)
library(dplyr)
library(ggplot2)
df %>% select(colnames(df), df[,1:5], sample) %>%
  pivot_longer(., cols = c(df[,1:5]), names_to = "Var", values_to = "Val") %>%
  ggplot(aes(x = Var, y = Val, fill = cat)) +
  geom_boxplot()

```


```{r}
ggplot(df, aes(rownames(df), value, col=variable ,color = factor(sample))) +
    geom_point() + 
    stat_smooth() 
    labs(subtitle = "aes(color) further divides data into more groups")

# Separate plots
ggplot(d, aes(rownames(df),value)) + 
  geom_point() + 
  stat_smooth() +
  facet_wrap(~variable)
```

```{r}


```

