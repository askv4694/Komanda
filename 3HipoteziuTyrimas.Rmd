---
title: "Hipotezių testas"
author: "Asta Kvedaraitė & Marius Survila"
date: "5/18/2020"
output: html_document
---

```{r echo = FALSE, message=FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  error = TRUE,
  echo = FALSE 
)
```

# Lyginamos grupės: sveiki/sergantys ir jų amžius.
```{r}
sample <- read.csv("../output/correctedSample.csv")
age <- sample$age
alzheimer <- sample$sample
test <- t.test(age ~ alzheimer)
test$statistic[[1]]
```
Norint nustatyti sveikų ir sergančių amžiaus vidurkį, buvo atliktas T testas dviem nepriklausomoms grupėms.
Sveikų žmonių grupės amžiaus vidurkis yra `r test$estimate[[2]]`, o sergančiųjų ažmiaus vidurkis = `r test$estimate[[1]]`.
P-reikšmė = `r test$p.value`, `r test$statistic[[1]]`.

```{r}
plot(sample$age~ sample$sample, main= "Sveikų ir sergančių amžiaus pasiskirstymas", xlab = NA, ylab ="Age")

```


```{r}
if (!require("matrixTests")) install.packages("matrixTests")
library("matrixTests")
library("ggplot2")
library("tidyverse")
data <- readRDS("../output/betab.rds")
nrow(data)

dfdata <- matrixTests::row_t_onesample(data)
dfdata <- dfdata[order(dfdata$statistic, decreasing = TRUE),]
df <- rownames(dfdata[1:5,])
df <- as.data.frame(data[df,])
df <- as.data.frame(t(df))
df$sample <- sample$sample
head(df)
ggplot(as.data.frame(df), aes(x = rownames(df), y = df[,1])) +
  geom_point(color = "red")

```

